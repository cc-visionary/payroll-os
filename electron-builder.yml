# =============================================================================
# PeopleOS PH - Electron Builder Configuration
# =============================================================================
# Configuration for building desktop installers for Windows, macOS, and Linux.
# =============================================================================

appId: com.peopleos.payroll
productName: PeopleOS Payroll
copyright: Copyright Â© 2026 PeopleOS

directories:
  output: dist
  buildResources: resources

# Files to include in the build
files:
  - .next/standalone/**/*
  - .next/static/**/*
  - public/**/*
  - dist-electron/**/*
  - package.json
  - .env
  # Include electron-updater and all its dependencies for auto-updates
  - node_modules/electron-updater/**/*
  - node_modules/builder-util-runtime/**/*
  - node_modules/argparse/**/*
  - node_modules/debug/**/*
  - node_modules/fs-extra/**/*
  - node_modules/graceful-fs/**/*
  - node_modules/js-yaml/**/*
  - node_modules/jsonfile/**/*
  - node_modules/lazy-val/**/*
  - node_modules/lodash.escaperegexp/**/*
  - node_modules/lodash.isequal/**/*
  - node_modules/ms/**/*
  - node_modules/sax/**/*
  - node_modules/semver/**/*
  - node_modules/tiny-typed-emitter/**/*
  - node_modules/universalify/**/*
  # Exclude build artifacts and unnecessary files
  - "!.next/standalone/dist/**"
  - "!.next/standalone/.next/cache/**"
  - "!**/node_modules/.cache/**"
  - "!**/*.map"

# Extra resources (Prisma, Node.js runtime, etc.)
extraResources:
  - from: prisma
    to: prisma
    filter:
      - "schema.prisma"
      - "migrations/**/*"
  # Node.js runtime for running the Next.js server
  # Downloaded during build process
  - from: node-runtime
    to: node-runtime
    filter:
      - "**/*"

# Use asar for packaging (security)
asar: true

# =============================================================================
# Windows Configuration
# =============================================================================
win:
  target:
    - target: nsis
      arch:
        - x64
  icon: resources/icons/people.png
  artifactName: ${productName}-Setup-${version}.${ext}

nsis:
  oneClick: false
  allowToChangeInstallationDirectory: true
  createDesktopShortcut: true
  createStartMenuShortcut: true
  shortcutName: PeopleOS Payroll

# =============================================================================
# macOS Configuration
# =============================================================================
mac:
  target:
    - target: dmg
      arch:
        - x64
        - arm64
  category: public.app-category.business
  icon: resources/icons/people.png
  artifactName: ${productName}-${version}-${arch}.${ext}

dmg:
  contents:
    - x: 130
      y: 220
    - x: 410
      y: 220
      type: link
      path: /Applications

# =============================================================================
# Linux Configuration
# =============================================================================
linux:
  target:
    - target: AppImage
      arch:
        - x64
  category: Office
  icon: resources/icons/people.png
  artifactName: ${productName}-${version}.${ext}

# =============================================================================
# Auto-updater Configuration
# =============================================================================
# Configure for GitHub releases
publish:
  provider: github
  owner: cc-visionary
  repo: payroll-os
  releaseType: release
